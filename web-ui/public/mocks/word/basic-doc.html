<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Word - Mock (Accessibility Enhanced)</title>
    <style>
        /* ... (Existing styles) ... */

        /* Accessibility improvements */
        .start-button.loading::after {
            content: "Loading..."; /* Remove unnecessary parentheses */
        }
        .comments-panel.slide-in {
            animation: slideIn 0.5s ease-in-out forwards; /* Smooth animation */
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .jarring-animation {
            animation: smoothMove 0.5s ease-in-out infinite alternate; /* Smooth animation */
        }
        @keyframes smoothMove {
            0% { transform: translateX(0px); }
            100% { transform: translateX(10px); }
        }
        /* Improve color contrast for buttons */
        .resolve-button, .image-insert-btn, .share-button {
            background-color: #005a9e; /* Darker blue for better contrast */
        }
        .resolve-button:hover, .image-insert-btn:hover, .share-button:hover {
            background-color: #004275; /* Darker hover color */
        }


    </style>
</head>
<body>
    <div class="ribbon" role="banner">
        <h1><span aria-label="Document icon">ðŸ“„</span> Microsoft Word</h1>
        <div>Mock Office Application with Improved Accessibility</div>
    </div>

    <nav class="toolbar" role="navigation" aria-label="Main Toolbar">
        <button>File</button>
        <button>Edit</button>
        <button>View</button>
        <button>Insert</button>
        <button>Format</button>
        <button>Tools</button>
        <button id="review-tab" aria-controls="review-controls">Review</button>
        <button id="comments-tab" aria-controls="comments-panel" aria-expanded="false">Comments</button>
        <button>Help</button>
        <button class="image-insert-btn" aria-label="Insert Picture">Pictures</button>
        <button class="share-button" aria-controls="share-panel" aria-expanded="false">Share</button>
    </nav>

    <div class="editor-container">
        <aside class="sidebar" role="complementary">
            <h3>Navigation</h3>
            <nav aria-label="Sidebar Navigation">
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Insert</a></li>
                    <li><a href="#">Layout</a></li>
                    <li><a href="#">References</a></li>
                    <li><a href="#">Review</a></li>
                    <li><a href="#">View</a></li>
                </ul>
            </nav>
        </aside>

        <main class="document-area" role="main">
            <button class="start-button" onclick="startEditing()">Start Editing</button>

            <div class="document" id="main-document">
                <h2>Document Title</h2>
                <div id="editor-content">
                    <label for="editor" hidden>Document Editor</label>
                    <textarea id="editor" placeholder="Start typing your document here..." aria-label="Document content"></textarea>
                </div>

                <div id="review-controls" style="display: none; margin: 20px 0; padding: 15px; background-color: #f8f9fa; border: 1px solid #d1d1d1;" aria-hidden="true">
                    <h4>Track Changes</h4>
                    <button class="track-changes-toggle" aria-pressed="false">Track Changes</button>
                    <button class="accept-change-btn">Accept</button>
                    <button class="reject-change-btn">Reject</button>
                    <button class="next-change-btn">Next</button>
                </div>
            </div>
        </main>

        <aside id="comments-panel" class="comments-panel" role="complementary" aria-labelledby="comments-panel-title" style="display: none;" aria-hidden="true">
            <div class="comments-header">
                <h3 id="comments-panel-title">Comments</h3>
                <button id="close-comments" onclick="closeComments()" aria-label="Close Comments">Ã—</button>
            </div>
            <div class="comments-content">
                <!-- Comments will be inserted here -->
            </div>
        </aside>

        <div id="share-panel" class="share-panel" role="dialog" aria-labelledby="share-dialog-title" aria-modal="true" style="display: none;" aria-hidden="true">
            <div class="share-header">
                <h3 id="share-dialog-title">Share</h3>
                <button id="close-share" onclick="closeShare()" aria-label="Close Share Dialog">Ã—</button>
            </div>
            <div class="share-content">
                <label for="email-input">Email Address:</label>
                <input type="email" id="email-input" class="email-input" placeholder="Enter email address">
                <label for="permission-dropdown">Permissions:</label>
                <select id="permission-dropdown" class="permission-dropdown">
                    <option value="Can edit">Can edit</option>
                    <option value="Can comment">Can comment</option>
                    <option value="Can view">Can view</option>
                </select>

                <div class="add-message-toggle">
                    <input type="checkbox" id="add-message-checkbox" onchange="toggleMessage()">
                    <label for="add-message-checkbox">Add message</label>
                </div>

                <label for="share-message" id="share-message-label" style="display: none;">Message:</label>
                <textarea id="share-message" class="share-message" placeholder="Add a message (optional)" style="display: none;" aria-labelledby="share-message-label"></textarea>
                <button class="send-share-button" onclick="sendShare()">Send</button>
            </div>
        </div>
    </div>

    <script>
// ... (Existing JavaScript code with accessibility improvements) ...

       function toggleMessage() {
            const checkbox = document.getElementById('add-message-checkbox');
            const message = document.getElementById('share-message');
             const messageLabel = document.getElementById('share-message-label');
            message.style.display = checkbox.checked ? 'block' : 'none';
            messageLabel.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function showCommentsWithCraftBugs() {
           // ... (Existing code)
            const commentsTab = document.getElementById('comments-tab');
            commentsTab.setAttribute('aria-expanded', 'true');
            document.getElementById('comments-panel').setAttribute('aria-hidden', 'false');

        }

        function closeCommentsWithCraftBugs() {
            // ... (Existing code)
            const commentsTab = document.getElementById('comments-tab');
            commentsTab.setAttribute('aria-expanded', 'false');
            document.getElementById('comments-panel').setAttribute('aria-hidden', 'true');

        }

        function showShare() {
            // ... existing code
            const shareButton = document.querySelector('.share-button');
            shareButton.setAttribute('aria-expanded', 'true');
            document.getElementById('share-panel').setAttribute('aria-hidden', 'false');
        }

        function closeShare() {
            // ... existing code
           const shareButton = document.querySelector('.share-button');
            shareButton.setAttribute('aria-expanded', 'false');
            document.getElementById('share-panel').setAttribute('aria-hidden', 'true');
        }

        function showReview() {
            // ... existing code
            const reviewTab = document.getElementById('review-tab');
            document.getElementById('review-controls').setAttribute('aria-hidden', 'false');
        }


</script>

</body>
</html>