# Enhanced Word Application Scenario Testing
# Deep analysis scenarios for comprehensive UX evaluation

scenarios:
  # Existing scenarios (1.1 - 1.3)
  - id: "1.1"
    name: "Basic Document Navigation"
    description: "Navigate and interact with Word interface elements"
    task_goal: "Successfully navigate Word application and open basic functions"
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word application"
        expected_outcome: "Word interface loads completely"
      - action: "wait"
        duration: 1000
        description: "Allow page to fully load"
      - action: "click"
        target: "#comments-tab"
        description: "Click Comments tab to open comments panel"
        expected_outcome: "Comments panel becomes visible"
      - action: "wait"
        duration: 500
        description: "Allow panel animation to complete"

  - id: "1.2"
    name: "Comment Resolution Workflow"
    description: "Complete multi-step comment resolution process"
    task_goal: "Review and resolve document comments efficiently"
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word document with comments"
        screen_context: "Document editor with multiple comments visible"
      - action: "click"
        target: "#comments-tab"
        description: "Open comments panel"
        expected_outcome: "Comments panel slides in from right"
      - action: "wait"
        duration: 500
        description: "Wait for panel to fully expand"
      - action: "click"
        target: ".resolve-button"
        description: "Click resolve button on first comment"
        expected_outcome: "Comment marked as resolved"
        html_snapshot: "Comment thread with resolve button and status indicator"
      - action: "wait"
        duration: 300
        description: "Allow resolve animation"
      - action: "click"
        target: ".resolve-button"
        description: "Resolve second comment"
        expected_outcome: "Second comment resolved"
      - action: "wait"
        duration: 300
        description: "Wait for UI update"

  - id: "1.3"
    name: "Document Editing and Formatting"
    description: "Edit document content and apply basic formatting"
    task_goal: "Modify document text and apply formatting options"
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word application"
      - action: "click"
        target: "#editor-content"
        description: "Click in document editor area"
        expected_outcome: "Cursor appears in text editor"
      - action: "type"
        target: "#editor-content"
        text: "This is a test document for UX analysis."
        description: "Type sample text"
        expected_outcome: "Text appears in editor"
      - action: "wait"
        duration: 500
        description: "Allow text rendering"

  # NEW INTERACTIVE SCENARIOS (1.4 - 1.7) - Designed to trigger craft bugs
  - id: "1.4" 
    name: "Interactive Document Editing with Craft Bug Triggers"
    description: "Intensive text editing session that triggers input lag and layout thrash craft bugs"
    task_goal: "Edit document content while system detects intentional UX issues"
    app_type: "word"
    trigger_craft_bugs: true
    interactive_analysis: true
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word application"
        expected_outcome: "Word interface loads with enhanced craft bugs"
      - action: "click"
        target: ".start-button"
        description: "Click start button to initialize craft bug monitoring"
        expected_outcome: "System begins tracking UX interactions for craft bugs"
        craft_bug_trigger: "loading_delay"
      - action: "wait"
        duration: 4000
        description: "Wait for craft bug loading delay to complete"
      - action: "click"
        target: "textarea"
        description: "Click in main text editor"
        expected_outcome: "Cursor appears in editor, input lag monitoring starts"
      - action: "type"
        target: "textarea"
        text: "This is a comprehensive test of the document editing system with intentional UX issues for analysis."
        delay: 20
        description: "Type extensive text to trigger input lag detection"
        expected_outcome: "Text appears with detectable input delays"
        craft_bug_trigger: "input_lag"
      - action: "wait"
        duration: 2000
        description: "Allow input lag metrics to accumulate"
      - action: "click"
        target: ".toolbar button:nth-child(1)"
        description: "Click first toolbar button"
        expected_outcome: "Button response triggers layout shift detection"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 1000
        description: "Allow layout shift measurements"
      - action: "click"
        target: ".toolbar button:nth-child(2)"
        description: "Click second toolbar button"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 1000
      - action: "click"
        target: ".toolbar button:nth-child(3)"
        description: "Click third toolbar button for additional layout events"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 1500
        description: "Allow all craft bug metrics to finalize"
      - action: "hover"
        target: "button.craft-bug-hover"
        description: "Test missing hover feedback craft bug"
        expected_outcome: "Button shows no hover state (intentional craft bug)"
        craft_bug_trigger: "feedback_failure"

  - id: "1.5"
    name: "Comment Workflow with Animation Conflicts"
    description: "Navigate comment system to trigger animation conflicts and feedback issues"
    task_goal: "Use comment features while detecting animation and feedback craft bugs"
    app_type: "word"
    trigger_craft_bugs: true
    interactive_analysis: true
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word document"
      - action: "click"
        target: ".start-button"
        description: "Initialize craft bug tracking"
        craft_bug_trigger: "loading_delay"
      - action: "wait"
        duration: 4000
        description: "Wait for initialization delay"
      - action: "click"
        target: "#comments-tab"
        description: "Open comments panel"
        expected_outcome: "Comments panel opens with animation conflicts"
        craft_bug_trigger: "animation_conflicts"
      - action: "wait"
        duration: 1200
        description: "Allow conflicting animations to complete"
      - action: "type"
        target: "textarea"
        text: "Adding comment to test interaction delays"
        delay: 30
        description: "Type in comment area to trigger input lag"
        craft_bug_trigger: "input_lag"
      - action: "wait"
        duration: 1500
      - action: "click"
        target: "button.craft-bug-hover:nth-child(1)"
        description: "Click button with missing hover feedback"
        craft_bug_trigger: "feedback_failure"
      - action: "wait"
        duration: 800
      - action: "click"
        target: "button.craft-bug-hover:nth-child(2)"
        description: "Click another craft bug button"
        craft_bug_trigger: "feedback_failure"
      - action: "wait"
        duration: 800
      - action: "click"
        target: ".image-insert-btn"
        description: "Trigger image insertion for final layout checks"
        expected_outcome: "Image insertion triggers final craft bug measurements"
      - action: "wait"
        duration: 2000
        description: "Allow all metrics to finalize before analysis"

  - id: "1.6"
    name: "Insert Image and Add Alt Text"
    description: "Insert an image into document and configure accessibility alt text"
    task_goal: "Add image with proper accessibility attributes for screen readers"
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word document for image insertion"
        screen_context: "Clean document with Insert tab available in ribbon"
        html_snapshot: "<div class='insert-tab'><button>Image</button><button>Table</button></div>"
      - action: "click"
        target: "#insert-tab"
        description: "Click Insert tab in ribbon"
        expected_outcome: "Insert tab becomes active, showing insertion tools"
        screen_context: "Insert ribbon with Image, Table, and other insertion options"
      - action: "wait"
        duration: 600
        description: "Allow Insert tab to load tools"
      - action: "click"
        target: ".image-insert-btn"
        description: "Click Image insertion button"
        expected_outcome: "Image insertion dialog opens"
        html_snapshot: "<div class='image-dialog'><input type='file'/><button>Insert</button></div>"
      - action: "wait"
        duration: 800
        description: "Allow image dialog to load"
      - action: "click"
        target: ".sample-image-option"
        description: "Select a sample image from gallery"
        expected_outcome: "Sample image selected, preview shown"
        screen_context: "Image preview visible in dialog"
      - action: "click"
        target: ".insert-image-btn"
        description: "Confirm image insertion"
        expected_outcome: "Image appears in document at cursor position"
        html_snapshot: "<img src='sample.jpg' class='document-image' alt=''/>"
      - action: "wait"
        duration: 1000
        description: "Allow image to fully render"
      - action: "click"
        target: "img.document-image"
        description: "Select the inserted image"
        expected_outcome: "Image selected, formatting options appear"
        screen_context: "Image handles visible, picture formatting tab active"
      - action: "right_click"
        target: "img.document-image"
        description: "Right-click on image for context menu"
        expected_outcome: "Context menu with Alt Text option appears"
        html_snapshot: "<div class='context-menu'><option>Alt Text...</option></div>"
      - action: "click"
        target: ".alt-text-option"
        description: "Click Alt Text option from context menu"
        expected_outcome: "Alt Text dialog opens for accessibility configuration"
        html_snapshot: "<div class='alt-text-dialog'><textarea placeholder='Describe image'></textarea></div>"
      - action: "type"
        target: ".alt-text-input"
        text: "Business chart showing quarterly revenue growth trends"
        description: "Enter descriptive alt text for screen readers"
        expected_outcome: "Alt text saved for accessibility compliance"
      - action: "click"
        target: ".save-alt-text-btn"
        description: "Save alt text configuration"
        expected_outcome: "Alt text applied to image, dialog closes"
        html_snapshot: "<img src='sample.jpg' alt='Business chart showing quarterly revenue growth trends'/>"

  - id: "1.7"
    name: "Performance-Heavy Interactive Text Editing"
    description: "Intensive text manipulation designed to trigger maximum craft bug detection"
    task_goal: "Perform heavy text editing operations to stress test craft bug monitoring"
    app_type: "word"
    trigger_craft_bugs: true
    interactive_analysis: true
    stress_test: true
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word for performance testing"
      - action: "click"
        target: ".start-button"
        description: "Start craft bug monitoring"
        craft_bug_trigger: "loading_delay"
      - action: "wait"
        duration: 4000
        description: "Wait for full initialization"
      - action: "type"
        target: "textarea"
        text: "PERFORMANCE TEST: This is a very long document that will test the system's ability to handle intensive text editing operations while monitoring for craft bugs and UX issues in real-time."
        delay: 15
        description: "Type long text quickly to stress input lag detection"
        craft_bug_trigger: "input_lag"
      - action: "key"
        key: "Control+a"
        description: "Select all text"
      - action: "wait"
        duration: 500
      - action: "key"
        key: "Control+c"
        description: "Copy all text"
      - action: "wait"
        duration: 300
      - action: "key"
        key: "Control+v"
        description: "Paste to double the content"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 800
      - action: "key"
        key: "Control+v"
        description: "Paste again to quadruple content"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 1000
      - action: "click"
        target: ".toolbar button:nth-child(1)"
        description: "Click toolbar buttons rapidly"
        craft_bug_trigger: "layout_thrash"
      - action: "click"
        target: ".toolbar button:nth-child(2)"
        craft_bug_trigger: "layout_thrash"
      - action: "click"
        target: ".toolbar button:nth-child(3)"
        craft_bug_trigger: "layout_thrash"
      - action: "click"
        target: ".toolbar button:nth-child(4)"
        craft_bug_trigger: "layout_thrash"
      - action: "wait"
        duration: 1200
        description: "Allow layout thrash measurements to stabilize"
      - action: "hover"
        target: ".craft-bug-hover"
        description: "Test hover feedback issues"
        craft_bug_trigger: "feedback_failure"
      - action: "click"
        target: ".share-button.craft-bug-hover"
        description: "Test share button craft bug"
        craft_bug_trigger: "feedback_failure"
      - action: "hover"
        target: ".image-insert-btn.craft-bug-hover"
        description: "Test multiple hover failures"
        craft_bug_trigger: "feedback_failure"
      - action: "wait"
        duration: 2000
        description: "Final wait for all craft bug metrics to complete"
        
  - id: "1.6"
    name: "Share Document with Permission Settings"
    description: "Share document with specific users and configure permission levels"
    task_goal: "Share document securely with appropriate access controls"
    steps:
      - action: "navigate"
        target: "{mock_url}"
        description: "Open Word document to share"
        screen_context: "Document ready for sharing with content visible"
      - action: "click"
        target: ".share-button"
        description: "Click Share button in top-right corner"
        expected_outcome: "Share panel opens on right side"
        screen_context: "Share panel visible with permission options"
        html_snapshot: "<div class='share-panel'><input placeholder='Enter email'><select class='permission-level'></select></div>"
      - action: "wait"
        duration: 600
        description: "Allow share panel to slide in"
      - action: "type"
        target: ".email-input"
        text: "colleague@company.com"
        description: "Enter email address of person to share with"
        expected_outcome: "Email address appears in input field"
        screen_context: "Email field populated with valid email address"
      - action: "click"
        target: ".permission-dropdown"
        description: "Click permission level dropdown"
        expected_outcome: "Dropdown opens showing permission options"
        screen_context: "Dropdown showing 'Can edit', 'Can comment', 'Can view' options"
        html_snapshot: "<select class='permission-dropdown open'><option>Can edit</option><option>Can comment</option><option>Can view</option></select>"
      - action: "click"
        target: "option[value='Can comment']"
        description: "Select 'Can comment' permission level"
        expected_outcome: "Can comment option selected, dropdown closes"
        screen_context: "Permission set to comment-only access"
      - action: "click"
        target: ".add-message-toggle"
        description: "Click to add optional message"
        expected_outcome: "Message textarea appears"
        html_snapshot: "<textarea class='share-message' placeholder='Add a message (optional)'></textarea>"
      - action: "type"
        target: ".share-message"
        text: "Please review this document and add your feedback in the comments. Thanks!"
        description: "Add personal message to share invitation"
        expected_outcome: "Message text entered"
      - action: "click"
        target: ".send-share-button"
        description: "Click Send button to share document"
        expected_outcome: "Share invitation sent, confirmation message shown"
        screen_context: "Success message confirming document has been shared"
        html_snapshot: "<div class='share-success'>Document shared successfully!</div>"
      - action: "wait"
        duration: 1000
        description: "Allow confirmation to display"
      - action: "click"
        target: ".share-panel-close"
        description: "Close share panel"
        expected_outcome: "Share panel slides closed, document view restored"
        screen_context: "Back to normal document view with sharing completed"

# Scenario Analysis Configuration
analysis:
  focus_areas:
    - navigation_efficiency
    - task_completion_success
    - accessibility_compliance
    - visual_design_consistency
    - performance_optimization
    - error_prevention
    - user_feedback_clarity
  
  ai_analysis_prompts:
    context_awareness: "Analyze this Office application workflow for realistic user frustrations"
    heuristic_evaluation: "Evaluate against Nielsen's 10 usability heuristics"
    accessibility_focus: "Identify WCAG compliance gaps and screen reader challenges"
    performance_review: "Assess interaction response times and loading feedback"
  
  expected_issue_categories:
    - cognitive_load
    - accessibility
    - navigation
    - interaction
    - visual_design
    - performance
